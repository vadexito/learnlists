<?php

$title = 'Learn at LearnLists';
$this->headTitle($title);
$this->placeholder('header')->captureStart();
?>
<header id="jumbotron-header">
    <div class="container">
        <h1><?php echo $this->escapeHtml($title); ?></h1>
    </div>
</header>
<?php $this->placeholder('header')->captureEnd(); ?>
<table class="table">
    <thead>
        <tr>
            <th></th>
            <th>Tags</th>
            <th>Rating</th>
            <th>Level</th>
            <th>Title</th>
        </tr>
    </thead>
    <tbody>
<?php foreach ($lists as $list) : ?>
      <tr>
        <td>
<?php if ($this->zfcUserIdentity() && ($list->author->getId() === $this->zfcUserIdentity()->getId())) :?> 
            <div class="btn-group">
                <a class="btn btn-primary" href="<?php echo $this->url('question',['action' => 'add','id' => $list->id]); ?>" title="<?php echo $this->translate('Add question'); ?>"><i class="icon-plus icon-white"></i></a>
                <a class="btn btn-primary" href="<?php echo $this->url('list',['action' => 'show','id' => $list->id]); ?>" title="<?php echo $this->translate('Edit list'); ?>"><i class="icon-edit icon-white"></i></a>
           </div>
<?php endif; ?>
        </td>
        <td><?php if (count($list->tags) > 0) : echo $this->escapeHtml(implode(', ',$list->tags->toArray())); endif; ?></td>
        <td>
            <?php if (isset($ratingService)) : echo round($ratingService->getRatingSet($list->id)->getAmount());endif; ?>
            <?php if ($this->zfcUserIdentity()) : ?><a href="<?php echo $this->url('list',['action' => 'rate','id' => $list->id]); ?>"><i class="icon-thumbs-up"></i></a><?php endif;?>
        </td>
        <td><?php echo $this->escapeHtml($list->level); ?></td>
        <td>
            <a href="<?php echo $this->url('question',['id' => $list->id]); ?>"><?php echo $this->escapeHtml($list->title); ?></a> 
            (<?php echo count($list->questions); ?> questions)
            <p>
                by <?php echo $this->gravatar($list->author->getEmail(),['img_size' => '20px']);echo ' '.$this->zfcUserDisplayName($list->author) ?> 
                (<?php echo $list->author->getRoles()[0]->getRoleId(); ?>), 
                created <?php echo $list->creationDate->format('Y-m-d'); ?>
            </p>
        </td>
      </tr>
<?php endforeach; ?>
    </tbody>
</table>