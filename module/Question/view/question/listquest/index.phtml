<?php

$title = 'Learn at LearnLists';
$this->headTitle($title);
$this->placeholder('header')->captureStart();
?>
<header id="jumbotron-header">
    <div class="container">
        <h1><?php echo $this->escapeHtml($title); ?></h1>
    </div>
</header>
<?php $this->placeholder('header')->captureEnd(); ?>
<table class="table">
    <thead>
        <tr>
            <th>#</th>
            <th>Tags</th>
            <th>Rating</th>
            <th>Level</th>
            <th>Title</th>
            <th>Questions</th>
        </tr>
    </thead>
    <tbody>
<?php foreach ($lists as $list) : ?>
      <tr>
        <td><?php echo $list->id; ?></td>
        <td><?php if (count($list->tags) > 0) : echo $this->escapeHtml(implode(', ',$list->tags->toArray())); endif; ?></td>
        <td>
            <?php if (isset($ratingService)) : echo round($ratingService->getRatingSet($list->id)->getAmount());endif; ?>
            <?php if ($this->zfcUserIdentity()) : ?><a href="<?php echo $this->url('list',['action' => 'rate','id' => $list->id]); ?>">Vote</a><?php endif;?>
        </td>
        <td><?php echo $this->escapeHtml($list->level); ?></td>
        <td>
            <a href="<?php echo $this->url('question',['id' => $list->id]); ?>"><?php echo $this->escapeHtml($list->title); ?></a>
            <p>
                by <?php echo $this->gravatar($list->author->getEmail(),['img_size' => '20px']);echo ' '.$this->zfcUserDisplayName($list->author) ?> 
                (<?php echo $list->author->getRoles()[0]->getRoleId(); ?>), 
                created <?php echo $list->creationDate->format('Y-m-d'); ?>
            </p>
        </td>
        <td>
            <?php echo count($list->questions); ?>
           <?php if ($this->zfcUserIdentity() && ($list->author->getId() === $this->zfcUserIdentity()->getId())) :?> - <a href="<?php echo $this->url('question',['action' => 'add','id' => $list->id]); ?>">Add</a><?php endif; ?>
        </td>       
      </tr>
<?php endforeach; ?>
    </tbody>
</table>