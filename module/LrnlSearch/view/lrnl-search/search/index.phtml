<?php

$title = $this->translate('Learn at LearnLists');
$this->headTitle($title);
$this->placeholder('header')->captureStart();
$searchForm->setAttribute('action', $this->url('lrnl-search'));
$searchForm->prepare();
?>

<div class="row-fluid search_bar_top">
    <div class="span12">
        <div class="row-fluid  well well-small">
            <?php echo $this->form()->openTag($searchForm);?>
            <?php echo $this->formRow($searchForm->get('search')); ?>
            <?php echo $this->formRow($searchForm->get('language')); ?>
            <button type="submit" class="btn btn-large btn-primary"><i class="icon-white icon-search"></i> <?php echo $this->translate('Search'); ?></button>
            <?php echo $this->form()->closeTag();?> 
        </div>
    </div>
</div>
<div class="row-fluid search_engine">
    <div class="span3">
        <div class="span11 well" id="left_side_filters">
            <?php foreach ($filterForm->getFieldsets() as $filter):  ?>
            <?php if ($filter->getAttribute('data-filterType') === 'checkbox'): ?>
            <div class="filter-search filter-search-term">
                <a type="button" data-toggle="collapse" data-target="#<?php $name = 'collapse'.$filter->getName();echo $name; ?>">
                    <h5 class="well"><?php echo ucfirst($this->translate($filter->getLabel())); ?></h5>
                </a>
                <div class="collapse in filter-choice" id="<?php echo $name; ?>">
                    <div class="well">
            <?php foreach ($filter->getElements() as $checkbox): 
                $checkbox->setAttribute('data-url',$this->url('lrnl-search',[],['query' => $checkbox->getQueryUrl()]));
                ?>
                        <label class="checkbox">
                            <?php echo $this->formCheckbox($checkbox); ?> <?php echo $checkbox->getLabel(); ?>
                            <span class="badge pull-right"><?php echo $checkbox->getAttribute('data-hitNb'); ?></span>
                        </label>
            <?php endforeach; ?>
                    </div>
                </div>
            </div>
            <?php endif;?>
            
            
            <?php if ($filter->getAttribute('data-filterType')==='range'): ?>
            <?php foreach ($filter->getElements() as $range): 
                $range->setAttribute('data-url',$this->url('lrnl-search',[],['query' => $range->getQueryUrl()]));
            ?>
            <div class="filter-search filter-search-range">
                <a type="button" data-toggle="collapse" data-target="#<?php $name = 'collapse'.$range->getName();echo $name; ?>">
                     <h5 class="well"><?php echo ucfirst($this->translate($range->getLabel())); ?></h5>
                </a>               
                <div class="collapse in filter-choice" id="<?php echo $name; ?>">
                    <div class="well">
                        <span class="min-slider label label-important pull-left"></span>
                        <span class="max-slider label label-important pull-right"></span>
                        <?php echo $this->formInput($range); ?>  
                    </div>
                </div>
            </div>
            <?php endforeach; ?>
            
            
            <?php endif;?>
            <?php if ($filter->getAttribute('data-filterType')==='search'): ?>
            <?php foreach ($filter->getElements() as $search): 
                $search->setAttribute('data-url',$this->url('lrnl-search',[],['query' => $search->getQueryUrl()]));            
            ?>
            <div class="filter-search filter-search-search">
                <a type="button" data-toggle="collapse" data-target="#<?php $name = 'collapse'.$search->getName();echo $name; ?>">
                    <h5 class="well"><?php echo $search->getLabel(); ?></h5>
                </a>
                <div class="collapse in filter-choice" id="<?php echo $name; ?>">
                    <div class="well input-append">
                        <?php echo $this->formInput($search); ?>
                        <button class="btn btn-primary">
                            <i class="icon icon-white icon-search"></i>
                        </button>
                    </div>
                </div>
            </div>
            <?php endforeach; ?>
            <?php endif;?>
            <?php endforeach; ?>
        </div>
    </div>
    <div class="span9" id="search_results_body">
        <div class="row-fluid  well well-small" id="search_result_summary">
            <?php echo sprintf($this->translate('%s results'),$resultNb); ?>
        </div>
        <hr>
        <div class="row-fluid">
            <ul id="search_result_lists">
                <?php echo $this->listquestCollection($lists); ?>               
            </ul>
            <?php echo $this->paginationControl($this->lists,'Sliding','pagination_control', ['route' => 'lrnl-search','query' => $query]); ?>
        </div>
        <div class="row-fluid" id="bottom_search_result_pagination_info">
            <div class="span6">
                <span id="search-results"></span>
            </div>
            <div class="span6" id="search_search-pagination"  class="pull-right"></div>
        </div>
    </div>
</div>
        